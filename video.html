<!DOCTYPE html>
<html>
<head>

	<title>LoL</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />
	<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
	<script src="jquery.lazyload.js" type="text/javascript"></script>    

	<style>
		.ui-block-a, 
		.ui-block-b, 
		.ui-block-c
		{
		background-color: lightgray;
		border: 1px solid black;
		height: 250px;
		width: 250px;
		font-weight: bold;
		text-align: center;
		}
        .img {
            height: 100%;
            width: 100%;
        }
	</style>

	<script>

    $(function(){
   
	    var data = {};
	    data.username = "vdgamers";
	    data.token = "7eb1d52ac16ae97b403b58f03b3301d14352e8d641b400a0";
	    data.page = 0;
	    data.count = 20;

	    $.getJSON( "http://api.videogami.co/clips", data, function( receivedData ) {
		    var items = [];
		    console.log(receivedData);
		    var output = "";
		    for (var i=0; i<receivedData.clips.length; i++){

			    grids = ['a','b','c'];
			    output = "<div class=\"ui-block-" + grids[i%3] + "\" id=\"" + receivedData.clips[i]._id + "\">" + 
                    "<img class=\"lazy\" data-original=\"" + receivedData.clips[i].gifs.normal + "\">" + " " + "</div>";
                $("#grid").append(output);

                $('#' + receivedData.clips[i]._id).click(function(){
                    var id = this.id;
                    var data = {};
	                data.username = "vdgamers";
	                data.token = "7eb1d52ac16ae97b403b58f03b3301d14352e8d641b400a0";
	                data.page = 0;
	                data.count = 1;
                    $.getJSON("http://api.videogami.co/video/" + id, data, function(receivedData){
                        $("#videoPopup").attr("src", receivedData.video.formats.mp4);
                        $("#video").click();
                    });               
                });
		    }	
		    
            $("img.lazy").lazyload({
                effect : "fadeIn"
            });
	    });	      
	});

	function scale( width, height, padding, border ) {
	    var scrWidth = $( window ).width() - 30,
	        scrHeight = $( window ).height() - 30,
	        ifrPadding = 2 * padding,
	        ifrBorder = 2 * border,
	        ifrWidth = width + ifrPadding + ifrBorder,
	        ifrHeight = height + ifrPadding + ifrBorder,
	        h, w;

	    if ( ifrWidth < scrWidth && ifrHeight < scrHeight ) {
	        w = ifrWidth;
	        h = ifrHeight;
	    } else if ( ( ifrWidth / scrWidth ) > ( ifrHeight / scrHeight ) ) {
	        w = scrWidth;
	        h = ( scrWidth / ifrWidth ) * ifrHeight;
	    } else {
	        h = scrHeight;
	        w = ( scrHeight / ifrHeight ) * ifrWidth;
	    }

	    return {
	        'width': w - ( ifrPadding + ifrBorder ),
	        'height': h - ( ifrPadding + ifrBorder )
	    };
	};

	$(document).on( "pageinit", function() {
	    $( "#popupVideo iframe" )
	        .attr( "width", 0 )
	        .attr( "height", 0 );
			  
	    $( "#popupVideo" ).on({
	        popupbeforeposition: function() {
	            var size = scale( 497, 298, 15, 1 ),
	                w = size.width,
	                h = size.height;

	            $( "#popupVideo iframe" )
	                .attr( "width", w )
	                .attr( "height", h );
	        },
	        popupafterclose: function() {
	            $( "#popupVideo iframe" )
	                .attr( "width", 0 )
	                .attr( "height", 0 );
	            $('#videoPopup').load();
	        }
	    });
	});

  	
  </script>

</head>

<body>

    <div data-role="page">

		<div data-role="header">
			<h1>Welcome To My Homepage</h1>
		</div>

		<div data-role="content">
			<p>Three-column Styled Layout:</p>
			<a id="video" href="#popupVideo" data-rel="popup" data-position-to="window" data-role="button" data-theme="b" data-inline="true" style='display:none;'></a> 
			<div data-role="popup" id="popupVideo" data-overlay-theme="a" data-theme="d" data-tolerance="15,15" class="ui-content">
    			<video id="videoPopup" width="640" height="480" controls>
                   <source src="test.mp4" type="video/mp4">
                                  Your browser does not support the video tag.
                </video> 
			</div>
			<div class="ui-grid-b" id="grid">
			    
			</div>
		</div>

		<div data-role="footer">
			...
		</div>
	</div>

</body>

</html>
